<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Othello — Stylish</title>

  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0B1030;
      --bg2:#101B42;

      --glass: rgba(255,255,255,.06);
      --glass2: rgba(255,255,255,.10);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.16);
      --text: #EAF0FF;
      --muted:#A9B6D6;

      --board0:#0b7c3f;
      --board1:#086a36;
      --grid: rgba(0,0,0,.28);

      --gold: #ffd37a;
      --gold2:#ffb86a;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --shadow2: 0 12px 24px rgba(0,0,0,.35);

      --r: 22px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
      color: var(--text);
      min-height:100svh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:22px;
      background:
        radial-gradient(900px 500px at 20% 10%, rgba(120,160,255,.25), transparent 60%),
        radial-gradient(900px 500px at 80% 10%, rgba(255,180,120,.18), transparent 55%),
        radial-gradient(900px 600px at 50% 85%, rgba(90,255,180,.10), transparent 62%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      overflow-x:hidden;
    }

    /* subtle noise */
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='240' height='240'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='240' height='240' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:.25;
    }

    .app{
      width:min(980px, 100%);
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:18px;
    }
    @media (max-width: 920px){
      .app{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius: var(--r);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(14px);
    }

    /* Header */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:16px 18px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
    }
    .brand{
      display:flex; align-items:center; gap:10px;
    }
    .logo{
      width:34px; height:34px; border-radius:12px;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.18), transparent 60%),
        linear-gradient(135deg, rgba(255,215,122,.75), rgba(120,170,255,.60));
      border: 1px solid rgba(255,255,255,.18);
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
    }
    .brand h1{
      margin:0;
      font-size:16px;
      letter-spacing:.2px;
      line-height:1.1;
    }
    .brand small{
      display:block;
      color: var(--muted);
      font-weight:600;
      font-size:12px;
      margin-top:2px;
    }
    .pill{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.12);
      box-shadow: var(--shadow2);
      font-weight:800;
      letter-spacing:.1px;
    }
    .turnDot{
      width:10px; height:10px; border-radius:999px;
      box-shadow: 0 8px 18px rgba(0,0,0,.35);
    }
    .turnDot.black{ background:#0b1020; border:1px solid rgba(255,255,255,.18); }
    .turnDot.white{ background:#f1f5ff; border:1px solid rgba(0,0,0,.18); }

    /* Board area */
    .boardWrap{ padding:18px; }
    .boardFrame{
      border-radius: 24px;
      padding:14px;
      background:
        radial-gradient(120% 80% at 30% 10%, rgba(255,255,255,.12), transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.16));
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25), var(--shadow2);
    }

    .board{
      width:100%;
      aspect-ratio: 1 / 1;
      border-radius: 18px;
      padding:10px;
      display:grid;
      grid-template-columns: repeat(8, 1fr);
      gap:2px;
      position:relative;
      background:
        radial-gradient(120% 90% at 20% 10%, rgba(255,255,255,.10), transparent 65%),
        radial-gradient(120% 90% at 80% 85%, rgba(0,0,0,.18), transparent 62%),
        linear-gradient(180deg, var(--board0), var(--board1));
      box-shadow:
        inset 0 0 0 2px rgba(0,0,0,.30),
        inset 0 30px 70px rgba(0,0,0,.18);
      overflow:hidden;
    }

    /* grid lines */
    .board::after{
      content:"";
      position:absolute; inset:10px;
      border-radius: 14px;
      background:
        linear-gradient(var(--grid) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid) 1px, transparent 1px);
      background-size: calc((100% - 0px)/8) calc((100% - 0px)/8);
      opacity:.35;
      pointer-events:none;
      mix-blend-mode: multiply;
    }

    .cell{
      position:relative;
      border-radius: 12px;
      background: rgba(0,0,0,.12);
      border: 1px solid rgba(0,0,0,.20);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      user-select:none;
      outline:none;
      transition: transform .06s ease, background .2s ease;
      z-index:1;
    }
    .cell:hover{ background: rgba(255,255,255,.06); }
    .cell:active{ transform: scale(.985); }
    .cell.disabled{ cursor:not-allowed; opacity:.85; }

    /* Hints */
    .cell.hint{
      box-shadow: inset 0 0 0 1px rgba(255,211,122,.25);
    }
    .cell.hint::before{
      content:"";
      position:absolute; inset:10px;
      border-radius: 10px;
      background: radial-gradient(circle at 30% 30%, rgba(255,211,122,.20), rgba(255,211,122,.06));
      box-shadow: inset 0 0 0 1px rgba(255,211,122,.55);
      opacity:.95;
      animation: pulse 1.5s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes pulse{
      0%,100%{ transform: scale(.98); opacity:.75; }
      50%{ transform: scale(1.02); opacity:1; }
    }

    .hintBadge{
      position:absolute;
      top:8px; right:8px;
      font-size:11px;
      font-weight:900;
      padding:4px 6px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.16);
      color: rgba(255,255,255,.92);
      transform: translateY(-2px);
      opacity:0;
      transition: opacity .15s ease, transform .15s ease;
      pointer-events:none;
    }
    .cell.hint:hover .hintBadge{
      opacity:1;
      transform: translateY(0);
    }

    /* Piece */
    .piece{
      width:72%;
      height:72%;
      border-radius:999px;
      position:relative;
      transform-style: preserve-3d;
      box-shadow:
        inset 0 12px 16px rgba(255,255,255,.12),
        inset 0 -18px 20px rgba(0,0,0,.28),
        0 10px 20px rgba(0,0,0,.30);
    }
    .piece::after{
      content:"";
      position:absolute; inset:10%;
      border-radius:999px;
      background: radial-gradient(circle at 30% 25%, rgba(255,255,255,.22), transparent 55%);
      filter: blur(.2px);
      opacity:.9;
      pointer-events:none;
    }
    .black{
      background: radial-gradient(circle at 30% 30%, #5b6474 0%, #111827 55%, #070B18 100%);
    }
    .white{
      background: radial-gradient(circle at 30% 30%, #ffffff 0%, #e7ecf5 55%, #cfd7e8 100%);
    }

    /* Animations */
    .drop .piece{ animation: drop .18s ease-out; }
    @keyframes drop{
      0%{ transform: translateY(-6px) scale(.92); filter: brightness(1.06); }
      100%{ transform: translateY(0) scale(1); }
    }

    .flip .piece{ animation: flip .22s ease-out; }
    @keyframes flip{
      0%{ transform: rotateY(0deg) scale(1); }
      49%{ transform: rotateY(90deg) scale(1.02); }
      100%{ transform: rotateY(0deg) scale(1); }
    }

    /* Side panel */
    .side{
      padding:18px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .status{
      min-height:44px;
      color: var(--muted);
      line-height:1.5;
      padding:12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.10);
    }

    .scoreGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .scoreCard{
      padding:12px 12px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.22);
    }
    .scoreTop{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .scoreLabel{
      display:flex; align-items:center; gap:8px;
      font-weight:900;
    }
    .dot{
      width:14px; height:14px; border-radius:999px;
      box-shadow: 0 6px 14px rgba(0,0,0,.25);
    }
    .dot.black{ background:#0b1020; border:1px solid rgba(255,255,255,.18); }
    .dot.white{ background:#f1f5ff; border:1px solid rgba(0,0,0,.18); }
    .scoreNum{
      font-variant-numeric: tabular-nums;
      font-size:22px;
      font-weight:950;
    }

    .controls{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:6px;
    }

    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 12px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04);
    }
    .rowTitle{
      font-weight:900;
      line-height:1.2;
    }
    .rowSub{
      font-size:12px;
      color: var(--muted);
      margin-top:2px;
      font-weight:700;
    }

    /* Switch */
    .switch{
      width:56px; height:32px;
      border-radius:999px;
      position:relative;
      cursor:pointer;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.14);
      transition: background .15s ease, border-color .15s ease;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.25);
      flex: 0 0 auto;
    }
    .switch.on{
      background: rgba(255,211,122,.22);
      border-color: rgba(255,211,122,.45);
    }
    .knob{
      position:absolute;
      top:3px; left:3px;
      width:26px; height:26px;
      border-radius:999px;
      background: rgba(255,255,255,.88);
      box-shadow: 0 10px 18px rgba(0,0,0,.25);
      transition: left .16s ease;
    }
    .switch.on .knob{ left:27px; }

    .btn{
      width:100%;
      padding:12px 14px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      cursor:pointer;
      font-weight:950;
      letter-spacing:.2px;
      transition: transform .06s ease, background .18s ease, border-color .18s ease;
      box-shadow: var(--shadow2);
    }
    .btn:hover{
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.18);
    }
    .btn:active{ transform: scale(.99); }

    .btn.primary{
      background: linear-gradient(135deg, rgba(255,211,122,.25), rgba(120,170,255,.18));
      border-color: rgba(255,255,255,.18);
    }

    .hintNote{
      color: rgba(169,182,214,.95);
      font-size:12px;
      line-height:1.5;
      margin-top:auto;
      padding:12px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.10);
    }
    kbd{
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
      padding:2px 6px;
      border-radius:8px;
      font-size:11px;
      font-weight:900;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      z-index:50;
    }
    .modal.show{ display:flex; }
    .modalCard{
      width:min(520px, 100%);
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modalHead{
      padding:16px 18px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,0));
    }
    .modalHead h2{
      margin:0;
      font-size:18px;
      font-weight:950;
      letter-spacing:.2px;
    }
    .modalBody{
      padding:16px 18px;
      color: var(--muted);
      line-height:1.6;
      font-weight:700;
    }
    .modalActions{
      padding:16px 18px;
      display:flex;
      gap:10px;
      border-top: 1px solid rgba(255,255,255,.08);
    }
    .modalActions button{ flex:1; }
  </style>
</head>

<body>
  <div class="app">
    <div class="card">
      <div class="topbar">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>Othello</h1>
            <small>Stylish single-file</small>
          </div>
        </div>
        <div class="pill" aria-live="polite">
          <span id="turnDot" class="turnDot black"></span>
          <span id="turnText">黒の番</span>
        </div>
      </div>

      <div class="boardWrap">
        <div class="boardFrame">
          <div id="board" class="board" aria-label="オセロ盤（8x8）"></div>
        </div>
      </div>
    </div>

    <div class="card side">
      <div id="status" class="status"></div>

      <div class="scoreGrid">
        <div class="scoreCard">
          <div class="scoreTop">
            <div class="scoreLabel"><span class="dot black"></span>黒</div>
            <div id="blackCount" class="scoreNum">2</div>
          </div>
          <div style="color:var(--muted);font-weight:700;font-size:12px;">あなた（左クリック）</div>
        </div>

        <div class="scoreCard">
          <div class="scoreTop">
            <div class="scoreLabel"><span class="dot white"></span>白</div>
            <div id="whiteCount" class="scoreNum">2</div>
          </div>
          <div style="color:var(--muted);font-weight:700;font-size:12px;">CPU/人</div>
        </div>
      </div>

      <div class="controls">
        <div class="row">
          <div>
            <div class="rowTitle">白をCPUにする</div>
            <div class="rowSub">いまはランダム合法手</div>
          </div>
          <div id="cpuSwitch" class="switch" role="switch" aria-checked="false" tabindex="0">
            <div class="knob"></div>
          </div>
        </div>

        <button id="restart" class="btn primary">リスタート</button>
      </div>

      <div class="hintNote">
        合法手はキラッとパルス表示。<br/>
        ホバーすると「返る枚数」が出る。<br/>
        <kbd>R</kbd> でもリスタート。
      </div>
    </div>
  </div>

  <!-- End modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modalCard">
      <div class="modalHead">
        <h2 id="modalTitle">終局</h2>
      </div>
      <div id="modalBody" class="modalBody"></div>
      <div class="modalActions">
        <button id="modalClose" class="btn">閉じる</button>
        <button id="modalRestart" class="btn primary">もう一回</button>
      </div>
    </div>
  </div>

  <script>
    // ---- Game core ----
    const SIZE = 8;
    const EMPTY = 0, BLACK = 1, WHITE = -1;
    const DIRS = [
      [-1,-1],[-1,0],[-1,1],
      [0,-1],        [0,1],
      [1,-1],[1,0],[1,1],
    ];

    let board = [];
    let current = BLACK;
    let gameOver = false;
    let cpuEnabled = false;

    // animation markers
    let animDrop = null;          // {r,c}
    let animFlips = [];           // [{r,c}]
    let clearAnimTimer = null;

    const elBoard = document.getElementById("board");
    const elStatus = document.getElementById("status");
    const elBlack = document.getElementById("blackCount");
    const elWhite = document.getElementById("whiteCount");
    const elRestart = document.getElementById("restart");
    const elCpuSwitch = document.getElementById("cpuSwitch");
    const elTurnDot = document.getElementById("turnDot");
    const elTurnText = document.getElementById("turnText");

    const elModal = document.getElementById("modal");
    const elModalBody = document.getElementById("modalBody");
    const elModalClose = document.getElementById("modalClose");
    const elModalRestart = document.getElementById("modalRestart");
    const elModalTitle = document.getElementById("modalTitle");

    function inBounds(r,c){ return r>=0 && r<SIZE && c>=0 && c<SIZE; }
    function turnName(p){ return p===BLACK ? "黒" : "白"; }

    function initBoard(){
      board = Array.from({length: SIZE}, () => Array(SIZE).fill(EMPTY));
      board[3][3] = WHITE;
      board[3][4] = BLACK;
      board[4][3] = BLACK;
      board[4][4] = WHITE;
      current = BLACK;
      gameOver = false;
      hideModal();
      setStatus(`${turnName(current)}の番です。`);
      render();
      maybeCpuMove();
    }

    function getFlips(r, c, player){
      if (!inBounds(r,c) || board[r][c] !== EMPTY) return [];
      const opp = -player;
      const flips = [];

      for (const [dr,dc] of DIRS){
        let rr = r + dr, cc = c + dc;
        const line = [];

        while (inBounds(rr,cc) && board[rr][cc] === opp){
          line.push([rr,cc]);
          rr += dr; cc += dc;
        }

        if (line.length > 0 && inBounds(rr,cc) && board[rr][cc] === player){
          for (const p of line) flips.push(p);
        }
      }
      return flips;
    }

    function getValidMoves(player){
      const moves = [];
      for (let r=0; r<SIZE; r++){
        for (let c=0; c<SIZE; c++){
          const flips = getFlips(r,c,player);
          if (flips.length) moves.push({r,c,flips});
        }
      }
      return moves;
    }

    function applyMove(move, player){
      board[move.r][move.c] = player;
      for (const [rr,cc] of move.flips){
        board[rr][cc] = player;
      }
    }

    function countPieces(){
      let b=0,w=0;
      for (let r=0; r<SIZE; r++){
        for (let c=0; c<SIZE; c++){
          if (board[r][c] === BLACK) b++;
          else if (board[r][c] === WHITE) w++;
        }
      }
      return {b,w};
    }

    function setStatus(text){
      elStatus.textContent = text;
    }

    function updateTurnUI(){
      elTurnDot.classList.toggle("black", current === BLACK);
      elTurnDot.classList.toggle("white", current === WHITE);
      elTurnText.textContent = `${turnName(current)}の番`;
    }

    function showModal(title, body){
      elModalTitle.textContent = title;
      elModalBody.textContent = body;
      elModal.classList.add("show");
    }
    function hideModal(){
      elModal.classList.remove("show");
    }

    function scheduleClearAnim(){
      if (clearAnimTimer) clearTimeout(clearAnimTimer);
      clearAnimTimer = setTimeout(() => {
        animDrop = null;
        animFlips = [];
        render(); // remove classes
      }, 260);
    }

    function checkEndOrPass(){
      const myMoves = getValidMoves(current);
      if (myMoves.length) return false;

      const other = -current;
      const otherMoves = getValidMoves(other);

      if (otherMoves.length){
        setStatus(`${turnName(current)}は置けないのでパス。${turnName(other)}の番です。`);
        current = other;
        render();
        maybeCpuMove();
        return true;
      }

      gameOver = true;
      const {b,w} = countPieces();
      let msg;
      if (b > w) msg = `黒 ${b} - 白 ${w} で黒の勝ち！`;
      else if (w > b) msg = `黒 ${b} - 白 ${w} で白の勝ち！`;
      else msg = `黒 ${b} - 白 ${w} で引き分け！`;

      setStatus(`終局：${msg}`);
      render();

      // modal
      showModal("終局", msg);
      return true;
    }

    function render(){
      // create cells once
      if (elBoard.children.length !== SIZE*SIZE){
        elBoard.innerHTML = "";
        for (let r=0; r<SIZE; r++){
          for (let c=0; c<SIZE; c++){
            const cell = document.createElement("div");
            cell.className = "cell";
            cell.dataset.r = String(r);
            cell.dataset.c = String(c);
            cell.setAttribute("role", "button");
            cell.setAttribute("tabindex", "0");
            cell.setAttribute("aria-label", `セル ${r+1},${c+1}`);
            elBoard.appendChild(cell);
          }
        }
      }

      updateTurnUI();

      const moves = gameOver ? [] : getValidMoves(current);
      const moveMap = new Map(); // "r,c" -> flipsCount
      for (const m of moves){
        moveMap.set(`${m.r},${m.c}`, m.flips.length);
      }

      for (const cell of elBoard.children){
        const r = Number(cell.dataset.r);
        const c = Number(cell.dataset.c);
        const key = `${r},${c}`;

        const isHint = moveMap.has(key);
        cell.classList.toggle("hint", isHint);
        cell.classList.toggle("disabled", gameOver);

        // animation classes
        cell.classList.toggle("drop", animDrop && animDrop.r===r && animDrop.c===c);
        const isFlip = animFlips.some(p => p.r===r && p.c===c);
        cell.classList.toggle("flip", isFlip);

        cell.innerHTML = "";
        const v = board[r][c];
        if (v !== EMPTY){
          const p = document.createElement("div");
          p.className = `piece ${v === BLACK ? "black" : "white"}`;
          cell.appendChild(p);
        } else if (isHint){
          const b = document.createElement("div");
          b.className = "hintBadge";
          b.textContent = `+${moveMap.get(key)}`;
          cell.appendChild(b);
        }
      }

      const {b,w} = countPieces();
      elBlack.textContent = String(b);
      elWhite.textContent = String(w);
    }

    function handleMove(r,c){
      if (gameOver) return;
      if (cpuEnabled && current === WHITE) return;

      const flips = getFlips(r,c,current);
      if (!flips.length) return;

      // set anim markers
      animDrop = {r,c};
      animFlips = flips.map(([rr,cc]) => ({r: rr, c: cc}));

      applyMove({r,c,flips}, current);
      current = -current;

      setStatus(`${turnName(-current)}が置きました。${turnName(current)}の番です。`);
      render();
      scheduleClearAnim();

      checkEndOrPass();
      maybeCpuMove();
    }

    function maybeCpuMove(){
      if (gameOver) return;
      if (!(cpuEnabled && current === WHITE)) return;

      const moves = getValidMoves(WHITE);
      if (!moves.length){
        checkEndOrPass();
        return;
      }

      const pick = moves[Math.floor(Math.random() * moves.length)];
      setTimeout(() => {
        if (gameOver) return;

        animDrop = {r: pick.r, c: pick.c};
        animFlips = pick.flips.map(([rr,cc]) => ({r: rr, c: cc}));

        applyMove(pick, WHITE);
        current = BLACK;

        setStatus(`CPU（白）が置きました。黒の番です。`);
        render();
        scheduleClearAnim();

        checkEndOrPass();
      }, 260);
    }

    // Events
    elBoard.addEventListener("click", (e) => {
      const cell = e.target.closest(".cell");
      if (!cell) return;
      handleMove(Number(cell.dataset.r), Number(cell.dataset.c));
    });

    elBoard.addEventListener("keydown", (e) => {
      const cell = e.target.closest(".cell");
      if (!cell) return;
      if (e.key === "Enter" || e.key === " "){
        e.preventDefault();
        handleMove(Number(cell.dataset.r), Number(cell.dataset.c));
      }
    });

    window.addEventListener("keydown", (e) => {
      if (e.key.toLowerCase() === "r") initBoard();
      if (e.key === "Escape") hideModal();
    });

    elRestart.addEventListener("click", initBoard);

    function toggleCpu(){
      cpuEnabled = !cpuEnabled;
      elCpuSwitch.classList.toggle("on", cpuEnabled);
      elCpuSwitch.setAttribute("aria-checked", String(cpuEnabled));
      maybeCpuMove();
    }
    elCpuSwitch.addEventListener("click", toggleCpu);
    elCpuSwitch.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " "){
        e.preventDefault();
        toggleCpu();
      }
    });

    elModalClose.addEventListener("click", hideModal);
    elModalRestart.addEventListener("click", initBoard);
    elModal.addEventListener("click", (e) => {
      if (e.target === elModal) hideModal();
    });

    initBoard();
  </script>
</body>
</html>
